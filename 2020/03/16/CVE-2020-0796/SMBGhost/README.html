<h1 id="SMBGhost"><a href="#SMBGhost" class="headerlink" title="SMBGhost"></a>SMBGhost</h1><p>Simple scanner for CVE-2020-0796 - SMBv3 RCE.</p>
<p>The scanner is for meant only for testing whether a server is vulnerable. It is not meant for research or development, hence the fixed payload. </p>
<p>It checks for SMB dialect 3.1.1 and compression capability through a negotiate request.</p>
<p>A network dump of the scanner running against a Windows 2019 Server (10.0.0.133) can be found under <code>SMBGhost.pcap</code>. </p>
<h2 id="Usage"><a href="#Usage" class="headerlink" title="Usage"></a>Usage</h2><p><code>python3 scanner.py &lt;IP&gt;</code></p>
<h2 id="Workarounds"><a href="#Workarounds" class="headerlink" title="Workarounds"></a>Workarounds</h2><p><a href="https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/adv200005">ADV200005 | Microsoft Guidance for Disabling SMBv3 Compression</a></p>
<pre><code>Set-ItemProperty -Path &quot;HKLM:\SYSTEM\CurrentControlSet\Services\LanmanServer\Parameters&quot; DisableCompression -Type DWORD -Value 1 -Force
</code></pre>